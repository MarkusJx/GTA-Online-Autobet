const download_button=document.getElementById("download-button"),download_now=document.getElementById("download-now"),show_tag=document.getElementById("show-tag"),show_artifact=document.getElementById("show-artifact"),latest_devel_version=document.getElementById("latest-devel-version"),change_theme=document.getElementById("change-theme");setTimeout(()=>{isWindows()?tryLoadArtifact().then(()=>{console.log("tryLoadArtifact() finished")}):(document.getElementById("main-download-container-unsupported").style.visibility="visible",document.getElementById("main-download-container-unsupported").style.position="unset",document.getElementById("main-download-container-unsupported").style.display="block",document.getElementById("main-download-container").style.visibility="hidden",document.getElementById("main-download-container").style.position="absolute",document.getElementById("main-download-container").style.display="none")},500),new mdc.ripple.MDCRipple(download_button),new mdc.ripple.MDCRipple(download_now),new mdc.ripple.MDCRipple(show_tag),new mdc.ripple.MDCRipple(show_artifact),new mdc.ripple.MDCRipple(document.getElementById("goto-gh-issues")),new mdc.ripple.MDCRipple(document.getElementById("goto-downloads-unsupported")),new mdc.ripple.MDCRipple(change_theme);let license_dialog=new mdc.dialog.MDCDialog(document.getElementById("license-dialog"));const release_selector=new mdc.tabBar.MDCTabBar(document.getElementById("select-relese-tab-bar")),release_download_container=document.getElementById("release-download-container"),devel_download_container=document.getElementById("devel-download-container");let is_dark=!1,recentlyChanged=!1,latestArtifactId=null,redirectToRun=()=>{};function setArtifactNotfound(){download_dev.disabled=!0,show_artifact.disabled=!0,latest_devel_version.innerText="not available",latest_devel_version.classList="notfound",redirectToRun=()=>{}}async function tryLoadArtifact(){try{const api=new GithubApi("MarkusJx","autobet",void 0),artifactPrefix="autobet-",artifact=await api.getLatestArtifact(artifactPrefix);if(!artifact.hasOwnProperty("expired")||artifact.expired||!artifact.hasOwnProperty("id"))throw new Error("The artifact is either expired or the response could not be parsed");if(latestArtifactId=artifact.id,!(artifact.hasOwnProperty("name")&&artifact.name.length>artifactPrefix.length))throw new Error("The artifact object has no 'name' property");{const artifactVersion=artifact.name.replace(artifactPrefix,"");latest_devel_version.innerText=artifactVersion,latest_devel_version.classList=""}const getRunByArtifactId=async id=>{const workflows=await api.getWorkflows(),runs=workflows.workflow_runs;for(let i=0;i<runs.length;i++)try{if("completed"==runs[i].status&&"success"==runs[i].conclusion){let artifacts=await api.getArtifactsForWorkflow(runs[i].id);artifacts=artifacts.artifacts;for(let j=0;j<artifacts.length;j++)if(artifacts[i].id==id)return runs[i]}}catch(ignored){}return null},run=await getRunByArtifactId(latestArtifactId);if(null==run||!run.hasOwnProperty("html_url"))throw new Error("Could not get the workflow run associated with the artifact");redirectToRun=()=>{window.location=run.html_url},show_artifact.disabled=!1}catch(e){setArtifactNotfound(),console.error(`Exception thrown while trying to load the artifact information: ${e}`)}}function changeTheme(light){if(light){document.body.classList.remove("darktheme"),document.getElementById("theme-change-icon").classList.remove("darktheme"),document.getElementById("change-theme").classList.remove("darktheme");let elements=document.getElementsByClassName("code-background");for(let i=0;i<elements.length;i++)elements.item(i).classList.remove("darktheme");is_dark=!1,window.localStorage.setItem("darktheme","false")}else{document.body.classList.add("darktheme"),document.getElementById("theme-change-icon").classList.add("darktheme"),document.getElementById("change-theme").classList.add("darktheme");let elements=document.getElementsByClassName("code-background");for(let i=0;i<elements.length;i++)elements.item(i).classList.add("darktheme");is_dark=!0,window.localStorage.setItem("darktheme","true")}}show_artifact.addEventListener("click",()=>{redirectToRun()}),document.getElementById("select-stable-button").addEventListener("click",()=>{release_download_container.classList="download-option-container visible",devel_download_container.classList="download-option-container"}),document.getElementById("select-dev-button").addEventListener("click",()=>{release_download_container.classList="download-option-container invisible",devel_download_container.classList="download-option-container visible"}),change_theme.addEventListener("click",()=>{recentlyChanged||(changeTheme(is_dark),recentlyChanged=!0,setTimeout(()=>{recentlyChanged=!1},300))}),change_theme.addEventListener("mouseenter",()=>{change_theme.classList.contains("hovered")||change_theme.classList.add("hovered"),document.getElementById("theme-change-icon").style=""}),change_theme.addEventListener("mouseleave",()=>{change_theme.classList.contains("hovered")&&change_theme.classList.remove("hovered"),document.getElementById("theme-change-icon").style.margin="7.5px"}),document.getElementById("copyright-footer").addEventListener("click",()=>{license_dialog.open(),document.body.style.overflowY="hidden"}),license_dialog.listen("MDCDialog:closing",()=>{document.body.style.overflowY="visible"}),download_button.addEventListener("click",()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})});let scrolled=!1;function showDownloadButton(e){scrolled||($("#heading-download-container").addClass("scrolled"),$("#heading-download-background").addClass("scrolled"),setTimeout(()=>{$("#download-button").addClass("scrolled"),$("#download-button").prop("disabled",!1),document.body.style.overflowY="visible",$("body").unbind()},500),scrolled=!0)}function getOS(){var userAgent=window.navigator.userAgent,platform=window.navigator.platform,macosPlatforms,windowsPlatforms=["Win32","Win64","Windows","WinCE"],iosPlatforms=["iPhone","iPad","iPod"],os=null;return-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(platform)?os="Mac OS":-1!==iosPlatforms.indexOf(platform)?os="iOS":-1!==windowsPlatforms.indexOf(platform)?os="Windows":/Android/.test(userAgent)?os="Android":!os&&/Linux/.test(platform)&&(os="Linux"),os}function isWindows(){return!isMobile()&&"Windows"===getOS()}function getLatestVersion(fn,err){$.ajax({url:"https://api.github.com/repos/markusjx/gta-online-autobet/tags",success:result=>{try{fn(result[0].name)}catch(error){fn(null)}},error:err})}function getLicense(fn,err){$.ajax({url:"https://raw.githubusercontent.com/MarkusJx/GTA-Online-Autobet/master/LICENSE",success:fn,error:err})}function isMobile(){try{return!!/Android|webOS|iPhone|iPad|iPod|pocket|psp|kindle|avantgo|blazer|midori|Tablet|Palm|maemo|plucker|phone|BlackBerry|symbian|IEMobile|mobile|ZuneWP7|Windows Phone|Opera Mini/i.test(navigator.userAgent)}catch(e){return console.log("Error in isMobile"),!1}}document.addEventListener("scroll",()=>{0!=window.scrollY?document.getElementById("change-theme").classList.contains("shown")||document.getElementById("change-theme").classList.add("shown"):document.getElementById("change-theme").classList.remove("shown")}),$("body").on("mousewheel DOMMouseScroll MozMousePixelScroll",showDownloadButton),document.addEventListener("click",()=>showDownloadButton(null)),document.addEventListener("keypress",()=>showDownloadButton(null)),document.addEventListener("touchmove",()=>showDownloadButton(null)),setTimeout(()=>{function verNotFound(){document.getElementById("latest-version").style.color="red",$("#download-now").prop("disabled",!0),console.error("could not get latest version")}window.scrollTo(0,0);try{getLatestVersion(res=>{null!=res?(document.getElementById("latest-version").innerText=res,download_now.addEventListener("click",()=>{location.href="https://github.com/MarkusJx/GTA-Online-Autobet/releases/download/"+res+"/autobet.exe"}),show_tag.addEventListener("click",()=>{location.href="https://github.com/MarkusJx/GTA-Online-Autobet/releases/tag/"+res})):verNotFound()},verNotFound)}catch(e){verNotFound()}getLicense(res=>{let lt=/</g,gt=/>/g,ap=/'/g,ic=/"/g;const license_text=res.replace(lt,"&lt;").replace(gt,"&gt;").replace(ap,"&#39;").replace(ic,"&#34;");document.getElementById("license-dialog-content").innerHTML=license_text.split("\n").join("<br>")},()=>{console.error("Could not get license"),document.getElementById("copyright-footer").addEventListener("click",()=>{location.href="https://github.com/MarkusJx/GTA-Online-Autobet/blob/master/LICENSE"})}),changeTheme("true"!=window.localStorage.getItem("darktheme"))},100);